<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Godwin Yung" />

<meta name="date" content="2019-12-15" />

<title>Example 2: Delayed treatment effect</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Example 2: Delayed treatment effect</h1>
<h4 class="author">Godwin Yung</h4>
<h4 class="date">2019-12-15</h4>



<p>We provide here code to replicate Figures 3 and 4A from Example 2 of our manuscript. We rely on R packages tidyverse, plyr, and ggplot2 for cleaner coding and advanced visualizations.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">library</span>(npsurvSS)</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb1-3" title="3"><span class="kw">library</span>(ggplot2)</a></code></pre></div>
<div id="figure-3" class="section level2">
<h2>Figure 3</h2>
<p>Suppose 240 active and 120 control patients are enrolled over the course of 14 months and followed for 11 months. Assume that accrual follows a truncated exponential distribution with shape parameter 0.1; loss to follow-up follows a Weibull distribution with shape parameter 2 and scale parameter <span class="math inline">\(log(1/0.99)^{1/2}/25\)</span>, so that 1% of patients are permanently censored over 25 months of follow-up; and survivals follow exponential distributions with 9 and 6 month medians. All these information are captured in the following “arm” objects:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="co"># Active</span></a>
<a class="sourceLine" id="cb2-2" title="2">arm1 &lt;-<span class="st"> </span><span class="kw">create_arm</span>(<span class="dt">size=</span><span class="dv">240</span>,</a>
<a class="sourceLine" id="cb2-3" title="3">                   <span class="dt">accr_time=</span><span class="dv">14</span>,</a>
<a class="sourceLine" id="cb2-4" title="4">                   <span class="dt">accr_dist=</span><span class="st">&quot;truncexp&quot;</span>,</a>
<a class="sourceLine" id="cb2-5" title="5">                   <span class="dt">accr_param=</span><span class="fl">0.1</span>,</a>
<a class="sourceLine" id="cb2-6" title="6">                   <span class="dt">surv_scale=</span><span class="kw">per2haz</span>(<span class="dv">9</span>),</a>
<a class="sourceLine" id="cb2-7" title="7">                   <span class="dt">loss_scale=</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">/</span><span class="fl">0.99</span>)<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">25</span>,</a>
<a class="sourceLine" id="cb2-8" title="8">                   <span class="dt">loss_shape=</span><span class="dv">2</span>,</a>
<a class="sourceLine" id="cb2-9" title="9">                   <span class="dt">total_time=</span><span class="dv">25</span>)</a>
<a class="sourceLine" id="cb2-10" title="10"></a>
<a class="sourceLine" id="cb2-11" title="11"><span class="co"># Control</span></a>
<a class="sourceLine" id="cb2-12" title="12">arm0 &lt;-<span class="st"> </span><span class="kw">create_arm</span>(<span class="dt">size=</span><span class="dv">120</span>,</a>
<a class="sourceLine" id="cb2-13" title="13">                   <span class="dt">accr_time=</span><span class="dv">14</span>,</a>
<a class="sourceLine" id="cb2-14" title="14">                   <span class="dt">accr_dist=</span><span class="st">&quot;truncexp&quot;</span>,</a>
<a class="sourceLine" id="cb2-15" title="15">                   <span class="dt">accr_param=</span><span class="fl">0.1</span>,</a>
<a class="sourceLine" id="cb2-16" title="16">                   <span class="dt">surv_scale=</span><span class="kw">per2haz</span>(<span class="dv">6</span>),</a>
<a class="sourceLine" id="cb2-17" title="17">                   <span class="dt">loss_scale=</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">/</span><span class="fl">0.99</span>)<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">25</span>,</a>
<a class="sourceLine" id="cb2-18" title="18">                   <span class="dt">loss_shape=</span><span class="dv">2</span>,</a>
<a class="sourceLine" id="cb2-19" title="19">                   <span class="dt">total_time=</span><span class="dv">25</span>)</a></code></pre></div>
<p>To visualize accrual and loss-to-follow-up:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="co"># Accrual</span></a>
<a class="sourceLine" id="cb3-2" title="2"><span class="kw">tibble</span>(</a>
<a class="sourceLine" id="cb3-3" title="3">  <span class="dt">x =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">14</span>, <span class="fl">0.1</span>),</a>
<a class="sourceLine" id="cb3-4" title="4">  <span class="dt">y =</span> <span class="kw">paccr</span>(x, arm0)</a>
<a class="sourceLine" id="cb3-5" title="5">) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb3-6" title="6"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(x, y)) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-7" title="7"><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb3-8" title="8"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Time from first patient in (months)&quot;</span>,</a>
<a class="sourceLine" id="cb3-9" title="9">       <span class="dt">y =</span> <span class="st">&quot;Accrual CDF&quot;</span>)</a>
<a class="sourceLine" id="cb3-10" title="10"></a>
<a class="sourceLine" id="cb3-11" title="11"><span class="co"># Loss to follow-up</span></a>
<a class="sourceLine" id="cb3-12" title="12"><span class="kw">tibble</span>(</a>
<a class="sourceLine" id="cb3-13" title="13">  <span class="dt">x =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">25</span>, <span class="fl">0.1</span>),</a>
<a class="sourceLine" id="cb3-14" title="14">  <span class="dt">y =</span> <span class="kw">ploss</span>(x, arm0)</a>
<a class="sourceLine" id="cb3-15" title="15">) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb3-16" title="16"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(x, y)) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-17" title="17"><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb3-18" title="18"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Time from study entry (months)&quot;</span>,</a>
<a class="sourceLine" id="cb3-19" title="19">       <span class="dt">y =</span> <span class="st">&quot;Loss to follow-up CDF&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><img src="data:image/png;base64,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" /></p>
<p>In the manuscript, we explore the impact on power when survival in the active arm follows instead a 2-piece exponential distribution, where the first piece overlaps with the control arm and the second piece deviates in such a way that median survival remains at 9 months. Denoting the changepoint by <span class="math inline">\(\tau_1\)</span> and the arm-specific hazard rates by <span class="math inline">\(\lambda_0\)</span> and <span class="math inline">\((\lambda_{11}, \lambda_{12})=(\lambda_0, \lambda_{12})\)</span>, simple algebra dictates that <span class="math inline">\(\lambda_{12}=\{\lambda: e^{-\lambda(9-\tau_1)}=\frac{0.5}{e^{-\lambda_0 \tau_1}}\}\)</span>. We can utilize functions in npsurvSS to calculate and visualize survival in the active arm under various changepoints:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="co"># Calculate survival curves</span></a>
<a class="sourceLine" id="cb4-2" title="2">x.vec     &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">25</span>, <span class="fl">0.1</span>)  <span class="co"># vector of unique x-coordinates</span></a>
<a class="sourceLine" id="cb4-3" title="3">tau1.vec  &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="fl">4.5</span>, <span class="fl">1.5</span>) <span class="co"># vector of unique changepoints</span></a>
<a class="sourceLine" id="cb4-4" title="4">arm1t     &lt;-<span class="st"> </span>arm1             <span class="co"># initialize active arm</span></a>
<a class="sourceLine" id="cb4-5" title="5">y         &lt;-<span class="st"> </span><span class="kw">c</span>()              <span class="co"># vector or all y-coordinates</span></a>
<a class="sourceLine" id="cb4-6" title="6"><span class="cf">for</span> (tau1 <span class="cf">in</span> tau1.vec) {</a>
<a class="sourceLine" id="cb4-7" title="7">  <span class="co"># Update scale and interval parameters for the active arm</span></a>
<a class="sourceLine" id="cb4-8" title="8">  arm1t<span class="op">$</span>surv_scale    &lt;-<span class="st"> </span><span class="kw">c</span>(arm0<span class="op">$</span>surv_scale[<span class="dv">1</span>], <span class="kw">per2haz</span>(<span class="dv">9</span><span class="op">-</span>tau1, <span class="dv">1</span><span class="fl">-0.5</span><span class="op">/</span><span class="kw">psurv</span>(tau1, arm0, <span class="dt">lower.tail=</span>F)))</a>
<a class="sourceLine" id="cb4-9" title="9">  arm1t<span class="op">$</span>surv_interval &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, tau1, <span class="ot">Inf</span>)</a>
<a class="sourceLine" id="cb4-10" title="10">  </a>
<a class="sourceLine" id="cb4-11" title="11">  <span class="co"># Calculate y-coordinates</span></a>
<a class="sourceLine" id="cb4-12" title="12">  y &lt;-<span class="st"> </span><span class="kw">c</span>(y, <span class="kw">psurv</span>(x.vec, arm1t, <span class="dt">lower.tail=</span>F))</a>
<a class="sourceLine" id="cb4-13" title="13">}</a>
<a class="sourceLine" id="cb4-14" title="14"></a>
<a class="sourceLine" id="cb4-15" title="15"><span class="co"># Visualize survival curves</span></a>
<a class="sourceLine" id="cb4-16" title="16"><span class="kw">tibble</span>(</a>
<a class="sourceLine" id="cb4-17" title="17">  <span class="dt">tau1 =</span> <span class="kw">rep</span>(tau1.vec, <span class="dt">each=</span><span class="kw">length</span>(x.vec)), </a>
<a class="sourceLine" id="cb4-18" title="18">  <span class="dt">x =</span> <span class="kw">rep</span>(x.vec, <span class="kw">length</span>(tau1.vec)),</a>
<a class="sourceLine" id="cb4-19" title="19">  <span class="dt">y =</span> y</a>
<a class="sourceLine" id="cb4-20" title="20">) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb4-21" title="21"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(x, y)) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-22" title="22"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">color=</span><span class="kw">factor</span>(tau1), <span class="dt">lty=</span><span class="kw">factor</span>(tau1))) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-23" title="23"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Time from study entry (months)&quot;</span>,</a>
<a class="sourceLine" id="cb4-24" title="24">       <span class="dt">y =</span> <span class="st">&quot;Survival function&quot;</span>,</a>
<a class="sourceLine" id="cb4-25" title="25">       <span class="dt">color =</span> <span class="st">&quot;Changepoint&quot;</span>,</a>
<a class="sourceLine" id="cb4-26" title="26">       <span class="dt">lty =</span> <span class="st">&quot;Changepoint&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="figure-4a" class="section level2">
<h2>Figure 4A</h2>
<p>Finally, to calculate power for various non-parametric tests, we take advantage of <code>power_two_arm</code>’s ability to accomodate multiple tests at a time. For the sake of efficiency here, we will only consider changepoints 0, 0.5, 1, …, 5.5. In the manuscript, we consider changepoints 0, 0.1, 0.2, …, 5.9.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">tau1.vec &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="fl">5.5</span>, <span class="fl">0.5</span>) <span class="co"># vector of changepoints</span></a>
<a class="sourceLine" id="cb5-2" title="2">table_4a &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow=</span><span class="kw">length</span>(tau1.vec), <span class="dt">ncol=</span><span class="dv">7</span>)) <span class="co"># initialize results table</span></a>
<a class="sourceLine" id="cb5-3" title="3"><span class="cf">for</span> (r <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(tau1.vec)) {</a>
<a class="sourceLine" id="cb5-4" title="4">  </a>
<a class="sourceLine" id="cb5-5" title="5">  tau1 &lt;-<span class="st"> </span>tau1.vec[r]</a>
<a class="sourceLine" id="cb5-6" title="6">  </a>
<a class="sourceLine" id="cb5-7" title="7">  <span class="co"># Update scale and interval parameters for the active arm</span></a>
<a class="sourceLine" id="cb5-8" title="8">  arm1t<span class="op">$</span>surv_scale    &lt;-<span class="st"> </span><span class="kw">c</span>(arm0<span class="op">$</span>surv_scale[<span class="dv">1</span>], <span class="kw">per2haz</span>(<span class="dv">9</span><span class="op">-</span>tau1, <span class="dv">1</span><span class="fl">-0.5</span><span class="op">/</span><span class="kw">psurv</span>(tau1, arm0, <span class="dt">lower.tail=</span>F)))</a>
<a class="sourceLine" id="cb5-9" title="9">  arm1t<span class="op">$</span>surv_interval &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, tau1, <span class="ot">Inf</span>)</a>
<a class="sourceLine" id="cb5-10" title="10">  </a>
<a class="sourceLine" id="cb5-11" title="11">  <span class="co"># Calculate power and store results</span></a>
<a class="sourceLine" id="cb5-12" title="12">  table_4a[r,] &lt;-<span class="st"> </span><span class="kw">c</span>(tau1,</a>
<a class="sourceLine" id="cb5-13" title="13">                    <span class="kw">power_two_arm</span>(arm0, arm1t,</a>
<a class="sourceLine" id="cb5-14" title="14">                                  <span class="dt">test =</span> <span class="kw">list</span>(<span class="kw">list</span>(<span class="dt">test=</span><span class="st">&quot;weighted logrank&quot;</span>),</a>
<a class="sourceLine" id="cb5-15" title="15">                                              <span class="kw">list</span>(<span class="dt">test=</span><span class="st">&quot;weighted logrank&quot;</span>, <span class="dt">weight=</span><span class="st">&quot;n&quot;</span>),</a>
<a class="sourceLine" id="cb5-16" title="16">                                              <span class="kw">list</span>(<span class="dt">test=</span><span class="st">&quot;weighted logrank&quot;</span>, <span class="dt">weight=</span><span class="st">&quot;FH_p1_q1&quot;</span>),</a>
<a class="sourceLine" id="cb5-17" title="17">                                              <span class="kw">list</span>(<span class="dt">test=</span><span class="st">&quot;survival difference&quot;</span>, <span class="dt">milestone=</span><span class="dv">11</span>),</a>
<a class="sourceLine" id="cb5-18" title="18">                                              <span class="kw">list</span>(<span class="dt">test=</span><span class="st">&quot;rmst difference&quot;</span>, <span class="dt">milestone=</span><span class="dv">11</span>),</a>
<a class="sourceLine" id="cb5-19" title="19">                                              <span class="kw">list</span>(<span class="dt">test=</span><span class="st">&quot;percentile difference&quot;</span>, <span class="dt">percentile=</span><span class="fl">0.5</span>)))<span class="op">$</span>power)</a>
<a class="sourceLine" id="cb5-20" title="20">  </a>
<a class="sourceLine" id="cb5-21" title="21">}</a>
<a class="sourceLine" id="cb5-22" title="22"></a>
<a class="sourceLine" id="cb5-23" title="23"><span class="co"># Convert table to long format and re-label tests</span></a>
<a class="sourceLine" id="cb5-24" title="24">table_4a &lt;-<span class="st"> </span><span class="kw">gather</span>(table_4a, <span class="st">&quot;test&quot;</span>, <span class="st">&quot;power&quot;</span>, <span class="dv">2</span><span class="op">:</span><span class="dv">7</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb5-25" title="25"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">test =</span> <span class="kw">recode</span>(test, <span class="dt">X2 =</span> <span class="st">&quot;wlogrank (1)&quot;</span>,</a>
<a class="sourceLine" id="cb5-26" title="26">                       <span class="dt">X3 =</span> <span class="st">&quot;wlogrank (GB)&quot;</span>,</a>
<a class="sourceLine" id="cb5-27" title="27">                       <span class="dt">X4 =</span> <span class="st">&quot;wlogrank (FH)&quot;</span>,</a>
<a class="sourceLine" id="cb5-28" title="28">                       <span class="dt">X5 =</span> <span class="st">&quot;11-month surv diff&quot;</span>,</a>
<a class="sourceLine" id="cb5-29" title="29">                       <span class="dt">X6 =</span> <span class="st">&quot;11-month rmst diff&quot;</span>,</a>
<a class="sourceLine" id="cb5-30" title="30">                       <span class="dt">X7 =</span> <span class="st">&quot;median diff&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb5-31" title="31"><span class="st">  </span><span class="kw">as_tibble</span>()</a>
<a class="sourceLine" id="cb5-32" title="32"><span class="kw">names</span>(table_4a)[<span class="dv">1</span>] &lt;-<span class="st"> &quot;tau1&quot;</span></a></code></pre></div>
<p>The resulting table looks like this:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">table_4a</a>
<a class="sourceLine" id="cb6-2" title="2"><span class="co">#&gt; # A tibble: 72 x 3</span></a>
<a class="sourceLine" id="cb6-3" title="3"><span class="co">#&gt;     tau1 test         power</span></a>
<a class="sourceLine" id="cb6-4" title="4"><span class="co">#&gt;    &lt;dbl&gt; &lt;chr&gt;        &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb6-5" title="5"><span class="co">#&gt;  1   0   wlogrank (1) 0.915</span></a>
<a class="sourceLine" id="cb6-6" title="6"><span class="co">#&gt;  2   0.5 wlogrank (1) 0.912</span></a>
<a class="sourceLine" id="cb6-7" title="7"><span class="co">#&gt;  3   1   wlogrank (1) 0.912</span></a>
<a class="sourceLine" id="cb6-8" title="8"><span class="co">#&gt;  4   1.5 wlogrank (1) 0.913</span></a>
<a class="sourceLine" id="cb6-9" title="9"><span class="co">#&gt;  5   2   wlogrank (1) 0.917</span></a>
<a class="sourceLine" id="cb6-10" title="10"><span class="co">#&gt;  6   2.5 wlogrank (1) 0.924</span></a>
<a class="sourceLine" id="cb6-11" title="11"><span class="co">#&gt;  7   3   wlogrank (1) 0.934</span></a>
<a class="sourceLine" id="cb6-12" title="12"><span class="co">#&gt;  8   3.5 wlogrank (1) 0.946</span></a>
<a class="sourceLine" id="cb6-13" title="13"><span class="co">#&gt;  9   4   wlogrank (1) 0.959</span></a>
<a class="sourceLine" id="cb6-14" title="14"><span class="co">#&gt; 10   4.5 wlogrank (1) 0.974</span></a>
<a class="sourceLine" id="cb6-15" title="15"><span class="co">#&gt; # ... with 62 more rows</span></a></code></pre></div>
<p>It can be used to generate Figure 4A in the manuscript:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="kw">ggplot</span>(table_4a, <span class="kw">aes</span>(<span class="dt">x=</span>tau1, <span class="dt">y=</span>power)) <span class="op">+</span></a>
<a class="sourceLine" id="cb7-2" title="2"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">color=</span>test, <span class="dt">lty=</span>test)) <span class="op">+</span></a>
<a class="sourceLine" id="cb7-3" title="3"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;tau1&quot;</span>,</a>
<a class="sourceLine" id="cb7-4" title="4">       <span class="dt">y =</span> <span class="st">&quot;Power&quot;</span>,</a>
<a class="sourceLine" id="cb7-5" title="5">       <span class="dt">color =</span> <span class="st">&quot;Test&quot;</span>,</a>
<a class="sourceLine" id="cb7-6" title="6">       <span class="dt">lty =</span> <span class="st">&quot;Test&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
